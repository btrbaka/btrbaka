import{_ as b,c as g,w as m,a as o,f as y,g as S,H as n,S as _,V as f,b as h,U as C,d as I,o as c,e as U,Q as T,F as $}from"./index-CfvEuYu0.js";const L={data:()=>({rules:[e=>!!e||"Required."],url:"",username:"",password:"",refreshtoken:"",debugmodecheck:!1,stored_url:!1,stored_username:!1}),mounted(){const e=localStorage.getItem("url"),l=localStorage.getItem("usrnm");e&&(this.url=e.slice(0,-1),this.stored_url=!0),l&&(this.username=l,this.stored_username=!0)},methods:{async loginFunc(){let e=this.url;const l=new Date;e.startsWith("https")==!0?e=`${e}/`:e=`https://${e}/`;const t=this.username,u=this.password,d=this.refreshtoken;console.log(e),console.log(t),console.log(u);let a={"Content-Type":"application/x-www-form-urlencoded"};d!=""&&(s=`client_id=ANDR&grant_type=refresh_token&refresh_token=${d}`);let s=`client_id=ANDR&grant_type=password&username=${t}&password=${u}`;var i=await fetch(`${e}api/login/`,{method:"POST",headers:a,body:s});const V=document.querySelector("p.login-status-notice");var p=await i.json();if(console.log(i.ok),i.ok==!1)alert("Login failure. Wrong password? Try again.");else{let r=p.access_token,k=p.refresh_token;if(console.log(r),this.debugmodecheck&&alert(r),r.startsWith("undef")==!1){let w=l.getTime();localStorage.setItem("expirytime",w),localStorage.setItem("url",e),localStorage.setItem("usrnm",t),localStorage.setItem("token",r),localStorage.setItem("refresh",k)}V.innerHTML="Successfully logged in!"}},logOut(){localStorage.removeItem("url"),localStorage.removeItem("usrnm"),this.url=null,this.username=null}}};function N(e,l,t,u,d,a){return c(),g(I,{class:"d-flex flex-column justify-center page-container"},{default:m(()=>[o(n,{rules:e.rules,"hide-details":"auto",modelValue:e.url,"onUpdate:modelValue":l[0]||(l[0]=s=>e.url=s),label:"School URL",type:"text",class:"ma-2"},null,8,["rules","modelValue"]),o(n,{rules:e.rules,"hide-details":"auto",modelValue:e.username,"onUpdate:modelValue":l[1]||(l[1]=s=>e.username=s),label:"Username",type:"text",class:"ma-2"},null,8,["rules","modelValue"]),o(n,{rules:e.rules,modelValue:e.password,"onUpdate:modelValue":l[2]||(l[2]=s=>e.password=s),"hide-details":"auto",label:"Password",type:"password",class:"ma-2"},null,8,["rules","modelValue"]),o(n,{label:"Refresh token (Optional)",modelValue:e.refreshtoken,"onUpdate:modelValue":l[3]||(l[3]=s=>e.refreshtoken=s),type:"password",class:_(["ma-2",{"d-none":!e.debugmodecheck}])},null,8,["modelValue","class"]),l[7]||(l[7]=y("p",{class:"login-status-notice ma-2"},null,-1)),this.url&&this.username&&this.stored_url&&this.stored_username?(c(),g(f,{key:0,onClick:a.logOut,size:"large",class:"ma-2",rounded:"pill",color:"error"},{default:m(()=>l[5]||(l[5]=[h(" Clear & Log out ")])),_:1,__:[5]},8,["onClick"])):S("",!0),o(f,{onClick:a.loginFunc,size:"large",class:"ma-2",rounded:"pill"},{default:m(()=>l[6]||(l[6]=[h("Login")])),_:1,__:[6]},8,["onClick"]),o(C,{label:"Debug mode",modelValue:e.debugmodecheck,"onUpdate:modelValue":l[4]||(l[4]=s=>e.debugmodecheck=s)},null,8,["modelValue"])]),_:1,__:[7]})}const v=b(L,[["render",N],["__scopeId","data-v-71c361d3"]]),F={__name:"Account",setup(e){return(l,t)=>(c(),U($,null,[o(T,{title:"Account",class:"bg-transparent"}),o(v)],64))}};export{F as default};
