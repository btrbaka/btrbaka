import{$ as h}from"./index-CfvEuYu0.js";function p(){const t=h(!1);return{isRefreshing:t,refreshLogin:async()=>{t.value=!0;const o=new Date().getTime(),s=localStorage.getItem("expirytime");if(o>s){const a=localStorage.getItem("refresh"),c=localStorage.getItem("url"),i={"Content-Type":"application/x-www-form-urlencoded"},f=`client_id=ANDR&grant_type=refresh_token&refresh_token=${a}`;try{const e=await fetch(`${c}api/login/`,{method:"POST",headers:i,body:f});if(!e.ok){alert("Login failure. Refresh token expired? Go to the Account page to refresh your login.");return}const r=await e.json(),n=r.access_token,l=r.refresh_token;n.startsWith("undef")||(localStorage.setItem("expirytime",o),localStorage.setItem("token",n),localStorage.setItem("refresh",l))}catch(e){console.error("Error refreshing token:",e)}}t.value=!1}}}export{p as u};
